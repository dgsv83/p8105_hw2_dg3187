Homework 2
================
Danyang Gui

``` r
library(tidyverse)
```

    ## ── Attaching packages ───────────────────────────────────────────────────── tidyverse 1.3.0 ──

    ## ✓ ggplot2 3.3.2     ✓ purrr   0.3.4
    ## ✓ tibble  3.0.3     ✓ dplyr   1.0.2
    ## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
    ## ✓ readr   1.3.1     ✓ forcats 0.5.0

    ## ── Conflicts ──────────────────────────────────────────────────────── tidyverse_conflicts() ──
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
library(readxl)
```

## Problem 1

Read the Mr. Trashwheel dataset.

``` r
trashwheel_df = 
  read_xlsx(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "Mr. Trash Wheel",
    range = cell_cols("A:N")) %>%
  janitor::clean_names() %>%
  drop_na(dumpster) %>%
  mutate(
    sports_balls = round(sports_balls),
    sports_balls = as.integer(sports_balls)
  )
```

Read precipitation data\!

``` r
precip_2018 = 
  read_excel(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "2018 Precipitation",
    skip = 1
  ) %>%
  janitor::clean_names() %>%
  drop_na(month) %>%
  mutate(year = 2018) %>%
  relocate(year)
  
precip_2017 = 
  read_excel(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "2017 Precipitation",
    skip = 1
  ) %>%
  janitor::clean_names() %>%
  drop_na(month) %>%
  mutate(year = 2017) %>%
  relocate(year)
```

Now combine annual precipitation.

``` r
month_df =
  tibble(
    month  = 1:12,
    month_name = month.name
  )

precip_df= 
     bind_rows(precip_2018, precip_2017)

left_join(precip_df, month_df, by = "month")
```

    ## # A tibble: 24 x 4
    ##     year month total month_name
    ##    <dbl> <dbl> <dbl> <chr>     
    ##  1  2018     1  0.94 January   
    ##  2  2018     2  4.8  February  
    ##  3  2018     3  2.69 March     
    ##  4  2018     4  4.69 April     
    ##  5  2018     5  9.27 May       
    ##  6  2018     6  4.77 June      
    ##  7  2018     7 10.2  July      
    ##  8  2018     8  6.45 August    
    ##  9  2018     9 10.5  September 
    ## 10  2018    10  2.12 October   
    ## # … with 14 more rows

This dataset contains information from the Mr. TrashWheel trash
collector in Baltimore, Maryland. As trash enters the inner harbor, the
trashwheel collects that trash, and stores it in a dumpster. The dataset
contains information on year, month, and trash collected, include some
specific kinds of trash. There are a total of 344 rows in our final
datasets. Additional data sheets include month precipitation data.

## Problem 2

``` r
subway_df = 
  read_csv ("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
  janitor::clean_names() %>%
  select(-division, -exit_only, -staffing, -staff_hours, -ada_notes, -free_crossover, 
         -north_south_street, -east_west_street, -corner, -entrance_latitude,       -entrance_longitude,
         -station_location, -entrance_location) %>%
  mutate(entry = recode (entry, 'YES' = TRUE , 'NO' = FALSE ))
```

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_character(),
    ##   `Station Latitude` = col_double(),
    ##   `Station Longitude` = col_double(),
    ##   Route8 = col_double(),
    ##   Route9 = col_double(),
    ##   Route10 = col_double(),
    ##   Route11 = col_double(),
    ##   ADA = col_logical(),
    ##   `Free Crossover` = col_logical(),
    ##   `Entrance Latitude` = col_double(),
    ##   `Entrance Longitude` = col_double()
    ## )

    ## See spec(...) for full column specifications.

This data set is about subway system in NYC. I imported the csv file
into R and briefly cleaned the variable names with
janitor::clean\_names. Then, I excluded variables such as staffing,
entrance latitude, and entrance longitude,etc. There are 1868 rows and
19 columns in the existing dataframe now. After the first round of
cleaning, variables retained are line, station\_name, station\_latitude,
station\_longitude, route1, route2, route3, route4, route5, route6,
route7, route8, route9, route10, route11, entrance\_type, entry,
vending, ada. Thus far, the data is not yet tidy.

``` r
subway_df_clean =
  distinct(subway_df, station_name, line, ada) %>% 
  filter (ada == TRUE) %>% 
  nrow()
```

There are 465 distinct stations. 84 of them are ADA compliant.

``` r
proportion_denominator = 
  select (subway_df, entry, vending) %>% 
  filter (vending == "NO") %>% 
  nrow()

proportion_numerator = 
  select (subway_df, entry, vending) %>% 
  filter (entry == TRUE, vending == "NO") %>% 
  nrow()


proportion_numerator / proportion_denominator
```

    ## [1] 0.3770492

37.70492% of the entrances/exits without vending allow entrance.

``` r
subway_df_route =
  read_csv ("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
  janitor::clean_names() %>%
  select(-division, -exit_only, -staffing, -staff_hours, -ada_notes, -free_crossover, 
         -north_south_street, -east_west_street, -corner, -entrance_latitude,       -entrance_longitude,
         -station_location, -entrance_location) %>%
  mutate(route8 = recode (route8, '1' = "1" , '4' = "4", '5' = "5")) %>% 
  mutate(route9 = recode (route9, '2' = "2", '5' = "5")) %>% 
  mutate(route10 = recode (route10, '3' = "3"))%>% 
  mutate(route11 = recode (route11, '7' = "7"))
```

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_character(),
    ##   `Station Latitude` = col_double(),
    ##   `Station Longitude` = col_double(),
    ##   Route8 = col_double(),
    ##   Route9 = col_double(),
    ##   Route10 = col_double(),
    ##   Route11 = col_double(),
    ##   ADA = col_logical(),
    ##   `Free Crossover` = col_logical(),
    ##   `Entrance Latitude` = col_double(),
    ##   `Entrance Longitude` = col_double()
    ## )

    ## See spec(...) for full column specifications.

``` r
pivot_longer(
    subway_df_route,
    route1:route11,
    names_to = "route_number",
    values_to = "route_name"
)
```

    ## # A tibble: 20,548 x 10
    ##    line  station_name station_latitude station_longitu… entrance_type entry
    ##    <chr> <chr>                   <dbl>            <dbl> <chr>         <chr>
    ##  1 4 Av… 25th St                  40.7            -74.0 Stair         YES  
    ##  2 4 Av… 25th St                  40.7            -74.0 Stair         YES  
    ##  3 4 Av… 25th St                  40.7            -74.0 Stair         YES  
    ##  4 4 Av… 25th St                  40.7            -74.0 Stair         YES  
    ##  5 4 Av… 25th St                  40.7            -74.0 Stair         YES  
    ##  6 4 Av… 25th St                  40.7            -74.0 Stair         YES  
    ##  7 4 Av… 25th St                  40.7            -74.0 Stair         YES  
    ##  8 4 Av… 25th St                  40.7            -74.0 Stair         YES  
    ##  9 4 Av… 25th St                  40.7            -74.0 Stair         YES  
    ## 10 4 Av… 25th St                  40.7            -74.0 Stair         YES  
    ## # … with 20,538 more rows, and 4 more variables: vending <chr>, ada <lgl>,
    ## #   route_number <chr>, route_name <chr>

## Problem 3

``` r
pols_df = 
  read_csv ("./data/pols-month.csv") %>%
  janitor::clean_names() 
```

    ## Parsed with column specification:
    ## cols(
    ##   mon = col_date(format = ""),
    ##   prez_gop = col_double(),
    ##   gov_gop = col_double(),
    ##   sen_gop = col_double(),
    ##   rep_gop = col_double(),
    ##   prez_dem = col_double(),
    ##   gov_dem = col_double(),
    ##   sen_dem = col_double(),
    ##   rep_dem = col_double()
    ## )
